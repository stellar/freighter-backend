import { xdr } from "stellar-sdk";

// import { testLogger } from "../test-helper";
import { base64regex } from "../test-helper";
import {
  getLedgerKeyContractCode,
  getLedgerKeyWasmId,
  isTokenSpec,
  parseWasmXdr,
} from ".";

describe("Soroban RPC helpers", () => {
  const CONTRACT_ID =
    "CCWAMYJME4H5CKG7OLXGC2T4M6FL52XCZ3OQOAV6LL3GLA4RO4WH3ASP";
  const ledgerKeyContractData =
    "AAAABgAAAAAAAAABBPvqFiL57/vWE7XeDcrbEXd3WczIDEuhXJhgf2cYn/0AAAAUAAAAAQAAABMAAAAAJ/PWnON+45fjDbkk5muh5BWuW5A2nPtczJfqndGyNNgAAAABAAAAAgAAAA8AAAAITUVUQURBVEEAAAARAAAAAQAAAAMAAAAPAAAAB2RlY2ltYWwAAAAAAwAAAAAAAAAPAAAABG5hbWUAAAAOAAAAClRlc3QgVG9rZW4AAAAAAA8AAAAGc3ltYm9sAAAAAAAOAAAAA1RTVAAAAAAQAAAAAQAAAAEAAAAPAAAABUFkbWluAAAAAAAAEgAAAAAAAAAAjOiEfRh4kaFVQDu/CSTZLMtnyg0DbNowZ/G2nLES3Kw=";
  const contractWasmXdr =
    "AAAABwAAAAAn89ac437jl+MNuSTma6HkFa5bkDac+1zMl+qd0bI02AAAHS8AYXNtAQAAAAGAARZgBH5+fn4BfmACfn4BfmADfn5+AX5gAX4BfmAAAX5gAX8AYAR/fn9/AGABfwF+YAJ/fwF+YAR/f39/AX5gAn5+AX9gAn9/AGABfgBgA39+fgBgBX5/f39/AGACf34AYAABf2AFfn5+fn8AYAAAYAR+fn5+AGADfn5+AGACfn4AAlsPAWwBNwAAAWwBMQABAWwBXwACAWEBMAADAXgBMQABAXYBZwABAWkBOAADAWkBNwADAWkBNgABAWIBagABAW0BOQACAW0BYQAAAXgBMwAEAWwBMAABAWwBOAABAy0sBQYHCAkBCAQKCwwNDg8QERINEw8UFBQVAAESBwMBAQADAhMAARQCBA8EBBIFAwEAEQYZA38BQYCAwAALfwBBkILAAAt/AEGQgsAACweyAREGbWVtb3J5AgAKaW5pdGlhbGl6ZQAnBG1pbnQAKAlzZXRfYWRtaW4AKwlhbGxvd2FuY2UALQdhcHByb3ZlAC4HYmFsYW5jZQAvCHRyYW5zZmVyADANdHJhbnNmZXJfZnJvbQAyBGJ1cm4AMwlidXJuX2Zyb20ANQhkZWNpbWFscwA2BG5hbWUAOAZzeW1ib2wAOQFfADoKX19kYXRhX2VuZAMBC19faGVhcF9iYXNlAwIK1CgsFAAgAEIBQYDLHkGA0h8QkICAgAALJQAgABCRgICAACABIAKtQiCGQgSEIAOtQiCGQgSEEICAgIAAGgv+AQIBfwF+I4CAgIAAQRBrIgEkgICAgAACQAJAAkACQAJAAkAgACgCAA4FAAECAwQAC0HAgcCAAEEJEJKAgIAAIQIgASAAQRBqKQMANwMIIAEgACkDCDcDACACQYiBwIAAQQIgAUECEJOAgIAAEJSAgIAAIQIMBAtByYHAgABBBxCSgICAACAAKQMIEJSAgIAAIQIMAwtB0IHAgABBBRCSgICAACAAKQMIEJSAgIAAIQIMAgtB1YHAgABBBRCSgICAACAAKQMIEJSAgIAAIQIMAQsgAUHagcCAAEEFEJKAgIAANwMAIAFBARCVgICAACECCyABQRBqJICAgIAAIAILtgEDAX8CfgF/QQAhAkIAIQMCQAJAA0AgASACRg0BIAJBCUYNAkIBIQQCQCAAIAJqLQAAIgVB3wBGDQAgBa0hBAJAIAVBUGpBCkkNAAJAIAVBv39qQRpJDQAgBUGff2pBGUsNBSAEQkV8IQQMAgsgBEJLfCEEDAELIARCUnwhBAsgAkEBaiECIAQgA0IGhoQhAwwACwsgA0IIhkIOhA8LIACtQiCGQgSEIAGtQiCGQgSEEImAgIAACy8AAkAgASADRg0AAAALIACtQiCGQgSEIAKtQiCGQgSEIAGtQiCGQgSEEIqAgIAACzwBAX8jgICAgABBEGsiAiSAgICAACACIAE3AwggAiAANwMAIAJBAhCVgICAACEBIAJBEGokgICAgAAgAQsaACAArUIghkIEhCABrUIghkIEhBCFgICAAAtwAgF/AX4jgICAgABBIGsiACSAgICAACAAQgQ3AwgCQAJAIABBCGoQkYCAgAAiAUICEJeAgIAARQ0AIAFCAhCBgICAACIBQv8Bg0LNAFENAQAAC0GAgMCAAEErEJiAgIAAAAsgAEEgaiSAgICAACABCw8AIAAgARCNgICAAEIBUQsJABCfgICAAAALPQEBfyOAgICAAEEgayIBJICAgIAAIAFCBDcDCCABQQhqEJGAgIAAIABCAhCCgICAABogAUEgaiSAgICAAAuuAgMCfwF+AX8jgICAgABBwABrIgMkgICAgAAgA0EQaiACNwMAIAMgATcDCEIAIQIgA0IANwMAAkACQAJAIAMQkYCAgAAiAUIAEJeAgIAADQBBACEEQgAhAQwBCyABQgAQgYCAgAAhAkEAIQQCQANAIARBEEYNASADQRhqIARqQgI3AwAgBEEIaiEEDAALCyACQv8Bg0LMAFINASACQbCBwIAAQQIgA0EYakECEJuAgIAAIANBKGogAykDGBCcgICAACADKQMoUEUNASADKQMgIgJC/wGDQgRSDQEgAykDMCEFQgAgA0E4aikDABCdgICAACACQiCIpyIESyIGGyEBQgAgBSAGGyECCyAAIAE3AwggACACNwMAIAAgBDYCECADQcAAaiSAgICAAA8LAAALMgACQCACIARGDQAAAAsgACABrUIghkIEhCADrUIghkIEhCACrUIghkIEhBCLgICAABoLgwECAX8BfgJAAkACQCABp0H/AXEiAkHFAEYNAAJAIAJBC0cNACAAQRBqIAFCP4c3AwAgACABQgiHNwMIDAILIABCg5CA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";

  describe("getLedgerKeyContractCode", () => {
    it("will return ledger key for contract code", () => {
      const ledgerKeyXdr = getLedgerKeyContractCode(CONTRACT_ID);
      const ledgerKeyFromXdr = xdr.LedgerKey.fromXDR(ledgerKeyXdr, "base64");

      expect(typeof ledgerKeyXdr).toEqual("string");
      expect(base64regex.test(ledgerKeyXdr)).toBeTruthy();
      expect(ledgerKeyFromXdr).toBeInstanceOf(xdr.LedgerKey);
      expect(ledgerKeyFromXdr.switch().name).toEqual("contractData");
    });
    it("will throw when it fails to get ledger key", () => {
      expect(() => getLedgerKeyContractCode("not contract ID")).toThrowError();
    });
  });

  describe("getLedgerKeyWasmId", () => {
    it("will return the contract code ledger key for a contract ID", () => {
      const ledgerKeyWasmId = getLedgerKeyWasmId(ledgerKeyContractData);
      const ledgerKeyFromXdr = xdr.LedgerKey.fromXDR(ledgerKeyWasmId, "base64");

      expect(typeof ledgerKeyWasmId).toEqual("string");
      expect(base64regex.test(ledgerKeyWasmId)).toBeTruthy();
      expect(ledgerKeyFromXdr).toBeInstanceOf(xdr.LedgerKey);
      expect(ledgerKeyFromXdr.switch().name).toEqual("contractCode");
    });

    it("will throw when it fails to get wasm ID xdr", () => {
      expect(() => getLedgerKeyWasmId("not conract data xdr")).toThrowError();
    });
  });

  describe("parseWasmXdr", () => {
    it("will return a json schema of a contract spec", async () => {
      const spec = await parseWasmXdr(contractWasmXdr);
      expect(spec).toHaveProperty("definitions");
    });
  });

  describe("isTokenSpec", () => {
    it("will return a boolean indicating if the spec matches sep41 spec", async () => {
      const spec = await parseWasmXdr(contractWasmXdr);
      const isSep41 = isTokenSpec(spec);

      expect(isSep41).toBeTruthy();
    });

    it("will return false when the spec does match sep41", async () => {
      const isSep41 = isTokenSpec({});

      expect(isSep41).toBeFalsy();
    });
  });

  describe("isSacContractExecutable", () => {
    // const sac = { code: "wBTC", issuer: "GATALTGTWIOT6BUDBCZM3Q4OQ4BO2COLOAZ7IYSKPLC2PMSOPPGF5V56", contract: "CAP5AMC2OHNVREO66DFIN6DHJMPOBAJ2KCDDIMFBR7WWJH5RZBFM3UEI"}
    // const notSac = { code: "TST", issuer: "GCGORBD5DB4JDIKVIA536CJE3EWMWZ6KBUBWZWRQM7Y3NHFRCLOKYVAL", contract: "CCHKQGYTHKK5BGE5VCDGO72QPXXM4U674EZTV4ERKF6DQEPJVCRRHM4W"}
  });
});
